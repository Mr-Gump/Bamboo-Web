<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <!-- Required Meta Tags Always Come First -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Title -->
    <title>Bamboo Web|查看结果与导出</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="{% static '/ico/favicon.ico' %}">
    <link rel="stylesheet" href="{% static '/vendor/icon-set/style.css' %}">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

    <!-- CSS Front Template -->
    <link rel="stylesheet" href="{% static '/css/theme.min.css' %}">
</head>

<body>
<header>
    <div class="container-fluid row border-bottom">
        <nav class="navbar navbar-expand-md navbar-light ">
            <div class="avatar avatar-lg avatar-4by3 mr-2">
                <img class="avatar-img" src="{% static '/svg/brands/guideline.svg' %}" alt="Image Description">
            </div>
            <a href="#" class="navbar-brand">Bamboo Web</a>
            <button class="navbar-toggler" data-toggle="collapse" data-target="#menu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div id="menu" class="collapse navbar-collapse">
                <ul class="navbar-nav">
                    <li class="nav-item"><a href="http://bamboo.xjtu.edu.cn/" target="_blank"
                                            class="nav-link">Bamboo</a></li>
                    <li class="nav-item"><a href="http://necp.xjtu.edu.cn/" target="_blank" class="nav-link">NECP</a>
                    </li>
                    <li class="nav-item"><a href="http://www.xjtu.edu.cn/" target="_blank" class="nav-link">XJTU</a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>

    <div class="container">
        <div class="bg-light m-5">
            <ul class="step step-md">
                <li class="step-item">
                    <div class="step-content-wrapper">
                        <span class="step-icon step-icon-soft-primary">1</span>
                        <div class="step-content">
                            <h6 class="step-title">上传历史数据</h6>
                        </div>
                    </div>
                </li>

                <li class="step-item">
                    <div class="step-content-wrapper">
                        <span class="step-icon step-icon-soft-primary">2</span>
                        <div class="step-content">
                            <h6 class="step-title">添加预测数据</h6>

                        </div>
                    </div>
                </li>

                <li class="step-item">
                    <div class="step-content-wrapper">
                        <span class="step-icon step-icon-soft-primary">3</span>
                        <div class="step-content">
                            <h6 class="step-title">程序运行</h6>
                        </div>
                    </div>
                </li>
                <li class="step-item">
                    <div class="step-content-wrapper">
                        <span class="step-icon step-icon-primary text-light">4</span>
                        <div class="step-content">
                            <h6 class="step-title">查看结果和导出数据</h6>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>


</header>


<main>
    <div class="container">
        <div class="row">
            <div class="col-sm-9 pl-7">
                <!-- Dropdown -->
                <div class="dropdown">
                    <a class="btn btn-primary dropdown-toggle" href="#" id="dropdownMenuLink" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        请选择步数
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        {% for i in points %}
                            <a class="dropdown-item choice" href="#" id="{{ i }}">Step{{ i }}</a>
                        {% endfor %}


                    </div>
                </div>
                <!-- End Dropdown -->
            </div>
            <div class="col-sm-3 ">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-sm">
                    导出
                    <i class="tio-download-from-cloud"></i>
                </button>

                <!-- Modal -->
                <div class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog"
                     aria-labelledby="mySmallModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-sm" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title h4" id="mySmallModalLabel">导出选项</h5>
                                <button type="button" class="btn btn-xs btn-icon btn-ghost-secondary"
                                        data-dismiss="modal" aria-label="Close">
                                    <i class="tio-clear tio-lg"></i>
                                </button>
                            </div>
                            <div class="modal-body">

                                <!-- Checkbox Switch -->
                                <label class="toggle-switch d-flex mb-3" for="customSwitch1">
                                    <input type="checkbox" class="toggle-switch-input" id="customSwitch1">
                                    <span class="toggle-switch-label" id="data">
    <span class="toggle-switch-indicator"></span>
  </span>
                                    <span class="toggle-switch-content">
    <span class="d-block">数据</span>
    <small class="d-block text-muted">每步数据的 excel 文件</small>
  </span>
                                </label>
                                <!-- End Checkbox Switch -->
                                <!-- Checkbox Switch -->
                                <label class="toggle-switch d-flex mb-3" for="customSwitch2">
                                    <input type="checkbox" class="toggle-switch-input" id="customSwitch2">
                                    <span class="toggle-switch-label" id="image">
    <span class="toggle-switch-indicator"></span>
  </span>
                                    <span class="toggle-switch-content">
    <span class="d-block">图像</span>
    <small class="d-block text-muted">集总参数和分布参数的图像</small>
  </span>
                                </label>
                                <!-- End Checkbox Switch -->
                                <!-- Checkbox Switch -->
                                <label class="toggle-switch d-flex mb-3" for="customSwitch3">
                                    <input type="checkbox" class="toggle-switch-input" id="customSwitch3">
                                    <span class="toggle-switch-label" id="gif">
    <span class="toggle-switch-indicator"></span>
  </span>
                                    <span class="toggle-switch-content">
    <span class="d-block">gif 动图</span>
    <small class="d-block text-muted">将分布参数图像组合成动画,可展现变化过程</small>
  </span>
                                </label>
                                <!-- End Checkbox Switch -->
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                                <button type="button" id="export" class="btn btn-primary" data-dismiss="modal">导出
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-2 my-5">
                <aside class="js-navbar-vertical-aside navbar navbar-vertical-aside navbar-vertical navbar-expand-xl">
                    <ul class="navbar-nav navbar-nav-lg nav-tabs">

                        <li class="nav-item ">
                            <a class="nav-link text-primary" href="#" title="Documentation" id="1-option">
                                <i class="tio-arrow-doublesided-vertical nav-icon"></i>
                                <span class="text-truncate">功率轴向分布 </span>
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="#" title="Components" id="2-option">
                                <i class="tio-arrow-doublesided-horizontal nav-icon"></i>
                                <span class="text-truncate">功率径向分布</span>
                            </a>
                        </li>
                    </ul>
                </aside>
            </div>
            <div class="col-sm-9 ml-5 mt-5" id="graph">

            </div>


        </div>
    </div>
</main>

<footer>

</footer>
<!-- JS Global Compulsory -->
<script src="{% static '/vendor/jquery/dist/jquery.min.js' %}"></script>
<script src="{% static '/vendor/jquery-migrate/dist/jquery-migrate.min.js' %}"></script>
<script src="{% static '/vendor/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static '/vendor/hs-navbar-vertical-aside/hs-navbar-vertical-aside.min.js' %}"></script>
<!-- JS Front -->
<script src="{% static '/js/theme.min.js' %}"></script>
<script type="text/javascript" src="https://assets.pyecharts.org/assets/echarts.min.js"></script>


<script>
    $(document).on('ready', function () {
        // INITIALIZATION OF NAVBAR VERTICAL NAVIGATION
        // =======================================================
        var sidebar = $('.js-navbar-vertical-aside').hsSideNav();
    });
</script>

<script>

    var point_num = 1;
    var kind = 1;
    $(document).on('ready', function () {
        $.get("/data/graph/" + "{{ uid }}" + "?point_num=" + point_num + "&kind=" + kind, function (data, status) {
            $("#graph").html(data)
        });
    });
    $(".choice").on("click", function () {
            point_num = $(this).attr("id")

            $.get("/data/graph/" + "{{ uid }}" + "?point_num=" + point_num + "&kind=" + kind, function (data, status) {
                $("#graph").html(data)
            });
        }
    );
    $(".nav-link").on("click", function () {
            kind = $(this).attr("id").substr(0, 1)

            if (kind == 1) {
                $("#1-option").addClass("text-primary")
                $("#2-option").removeClass("text-primary")
            }
            if (kind == 2) {
                $("#2-option").addClass("text-primary")
                $("#1-option").removeClass("text-primary")
            }

            $.get("/data/graph/" + "{{ uid }}" + "?point_num=" + point_num + "&kind=" + kind, function (data, status) {
                $("#graph").html(data)
            });
        }
    );

    $("#export").on("click", function () {
        var data = 0
        var image = 0
        var gif = 0
        if ($("#customSwitch1").val() == 'off') {
            data = 1
        }
        if ($("#customSwitch2").val() == 'off') {
            image = 1
        }
        if ($("#customSwitch3").val() == 'off') {
            gif = 1
        }
        if (data == 0 && image == 0 && gif == 0) {
            alert("请至少选择一项进行导出!")
        } else {
            window.location.href = "/data/export/" + "{{ uid }}" +
                "?data=" + data + "&image=" + image + "&gif=" + gif
        }
    })

    $("#data").on("click", function () {
        if ($("#customSwitch1").val() == 'on') {
            $("#customSwitch1").val('off')
        } else {
            $("#customSwitch1").val('on')
        }
    })

    $("#image").on("click", function () {
        if ($("#customSwitch2").val() == 'on') {
            $("#customSwitch2").val('off')
        } else {
            $("#customSwitch2").val('on')
        }
    })

    $("#gif").on("click", function () {
        if ($("#customSwitch3").val() == 'on') {
            $("#customSwitch3").val('off')
        } else {
            $("#customSwitch3").val('on')
        }
    })

</script>
<footer class="text-center text-muted py-4 bg-dark">
    Copyright @Gump <a href="http://necp.xjtu.edu.cn/" target="_blank">XJTU-NECP</a>
</footer>

</body>
</html>